<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æŠ•è³‡ãƒ’ã‚¹ãƒˆãƒªãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;
  margin:15px;
  background:#f7f7f7;
}
h1,h2{text-align:center;}
.card{
  background:#fff;
  padding:15px;
  border-radius:12px;
  margin-bottom:15px;
}
input,select,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  font-size:16px;
}
button{
  background:#007aff;
  color:#fff;
  border:none;
  border-radius:10px;
}
.small{font-size:14px;color:#555;}
#finalAsset{
  font-size:28px;
  font-weight:bold;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>

<h1>ğŸ“ˆ æŠ•è³‡ãƒ’ã‚¹ãƒˆãƒªãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>

<div class="card">
  <label>åˆæœŸæŠ•è³‡é¡ï¼ˆå††ï¼‰</label>
  <input id="initialMoney" type="number" value="1000000">

  <label>å¹´åˆ©</label>
  <select id="returnRate">
    <option value="0.03">3%</option>
    <option value="0.05" selected>5%</option>
    <option value="0.07">7%</option>
    <option value="0.10">10%</option>
  </select>

  <button onclick="simulate()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>
</div>

<div class="card">
  <h2>æœ€çµ‚è³‡ç”£</h2>
  <div id="finalAsset">Â¥0</div>
</div>

<div class="card">
  <h2>è³‡ç”£æ¨ç§»ï¼ˆ1925å¹´ã€œ2025å¹´ï¼‰</h2>
  <canvas id="assetChart" height="120"></canvas>
  <p class="small">â€» æš´è½å¹´ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨è©³ç´°èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
</div>

<!-- æš´è½ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="crashModal" style="
display:none; position:fixed; inset:0;
background:rgba(0,0,0,0.5); z-index:999;">
  <div style="
  background:#fff; margin:20% auto; padding:15px;
  width:90%; border-radius:12px;">
    <h3 id="crashTitle"></h3>
    <p id="crashText" class="small"></p>
    <button onclick="closeCrash()">é–‰ã˜ã‚‹</button>
  </div>
</div>

<script>
// ===== æš´è½ãƒ‡ãƒ¼ã‚¿ =====
const crashInfo={
  1929:{title:"ä¸–ç•Œææ…Œ",text:"NYãƒ€ã‚¦ãŒæœ€å¤§ç´„90%ä¸‹è½ã€‚å›å¾©ã¾ã§ç´„25å¹´ã€‚"},
  1973:{title:"ã‚ªã‚¤ãƒ«ã‚·ãƒ§ãƒƒã‚¯",text:"ã‚¤ãƒ³ãƒ•ãƒ¬ã¨ä¸æ³ãŒåŒæ™‚é€²è¡Œã€‚"},
  1987:{title:"ãƒ–ãƒ©ãƒƒã‚¯ãƒãƒ³ãƒ‡ãƒ¼",text:"1æ—¥ã§20%ä»¥ä¸Šã®æš´è½ã€‚"},
  2000:{title:"ITãƒãƒ–ãƒ«å´©å£Š",text:"NASDAQãŒç´„75%ä¸‹è½ã€‚"},
  2008:{title:"ãƒªãƒ¼ãƒãƒ³ã‚·ãƒ§ãƒƒã‚¯",text:"ä¸–ç•ŒåŒæ™‚é‡‘èå±æ©Ÿã€‚"},
  2020:{title:"ã‚³ãƒ­ãƒŠã‚·ãƒ§ãƒƒã‚¯",text:"ãƒ‘ãƒ³ãƒ‡ãƒŸãƒƒã‚¯ã«ã‚ˆã‚‹æ€¥è½ã€‚"}
};

let chart;

// ===== ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ =====
function simulate(){
  const startYear=1925;
  const endYear=2025;
  const years=[];
  for(let y=startYear;y<=endYear;y++) years.push(y);

  let money=Number(initialMoney.value);
  const rate=Number(returnRate.value);
  const assets=[];

  years.forEach(y=>{
    if(y===1929) money*=0.6;
    if(y===2008) money*=0.7;
    if(y===2020) money*=0.8;
    money*=1+rate;
    assets.push(Math.round(money));
  });

  finalAsset.innerText="Â¥"+assets[assets.length-1].toLocaleString();
  drawChart(years,assets);
}

// ===== ã‚°ãƒ©ãƒ•æç”» =====
function drawChart(labels,data){
  if(chart) chart.destroy();
  chart=new Chart(assetChart,{
    type:"line",
    data:{
      labels,
      datasets:[{
        label:"è³‡ç”£é¡ï¼ˆå††ï¼‰",
        data,
        borderWidth:2,
        tension:0.2
      }]
    },
    options:{
      scales:{
        x:{title:{display:true,text:"å¹´"}},
        y:{
          title:{display:true,text:"é‡‘é¡ï¼ˆå††ï¼‰"},
          ticks:{callback:v=>"Â¥"+v.toLocaleString()}
        }
      },
      onClick:(e,els)=>{
        if(!els.length) return;
        const year=labels[els[0].index];
        if(crashInfo[year]) openCrash(crashInfo[year]);
      }
    }
  });
}

// ===== ãƒ¢ãƒ¼ãƒ€ãƒ« =====
function openCrash(info){
  crashTitle.innerText=info.title;
  crashText.innerText=info.text;
  crashModal.style.display="block";
}
function closeCrash(){
  crashModal.style.display="none";
}

// åˆæœŸè¡¨ç¤º
simulate();
</script>

</body>
</html>
