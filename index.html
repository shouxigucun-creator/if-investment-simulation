<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>100å¹´æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:-apple-system;background:#f5f5f7;margin:12px}
.card{background:#fff;padding:14px;border-radius:12px;margin-bottom:12px}
h1,h2{text-align:center}
input,select,button{width:100%;padding:10px;margin-top:6px;font-size:16px}
button{background:#007aff;color:#fff;border:none;border-radius:10px}
canvas{width:100%;height:280px;border:1px solid #ccc;border-radius:8px}
#final{font-size:30px;font-weight:bold;text-align:center}
.small{font-size:13px;color:#555}
</style>
</head>

<body>

<h1>ğŸ“ˆ æŠ•è³‡ãƒ’ã‚¹ãƒˆãƒªãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>

<div class="card">
  <label>æŠ•è³‡é–‹å§‹å¹´</label>
  <select id="startYear"></select>

  <label>æŠ•è³‡çµ‚äº†å¹´</label>
  <select id="endYear"></select>

  <label>åˆæœŸæŠ•è³‡é¡ï¼ˆå††ï¼‰</label>
  <input id="initial" type="number" value="1000000">

  <label>æœˆé¡ç©ç«‹ï¼ˆå††ï¼‰</label>
  <input id="monthly" type="number" value="30000">

  <label>éŠ˜æŸ„</label>
  <select id="stock">
    <option value="0.05">ã‚ªãƒ«ã‚«ãƒ³ï¼ˆå…¨ä¸–ç•Œæ ªï¼‰</option>
    <option value="0.07">S&P500</option>
    <option value="0.09">NASDAQ100</option>
    <option value="0.04">é«˜é…å½“æ ª</option>
    <option value="0.08">æ—¥æœ¬æ ªï¼ˆä»»å¤©å ‚ï¼‰</option>
    <option value="0.06">æ—¥æœ¬æ ªï¼ˆä¸‰è±UFJï¼‰</option>
    <option value="0.06">æ—¥æœ¬æ ªï¼ˆä¸‰è±é›»æ©Ÿï¼‰</option>
  </select>

  <label>å£åº§ç¨®åˆ¥</label>
  <select id="account">
    <option value="nisa">æ–°NISAï¼ˆéèª²ç¨ï¼‰</option>
    <option value="tax">ç‰¹å®šå£åº§ï¼ˆç¨å¼•ãï¼‰</option>
  </select>

  <label>
    <input type="checkbox" id="crashOn" checked> æš´è½ã‚’åæ˜ 
  </label>

  <button onclick="simulate()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
</div>

<div class="card">
  <h2>æœ€çµ‚è³‡ç”£ï¼ˆæ‰‹æ®‹ã‚Šï¼‰</h2>
  <div id="final">Â¥0</div>
</div>

<div class="card">
  <h2>è³‡ç”£æ¨ç§»</h2>
  <canvas id="graph" width="350" height="280"></canvas>
</div>

<script>
// ===== å¹´ã‚»ãƒ¬ã‚¯ãƒˆç”Ÿæˆ =====
const startSelect=document.getElementById("startYear");
const endSelect=document.getElementById("endYear");

for(let y=1925;y<=2025;y++){
  startSelect.innerHTML+=`<option value="${y}">${y}å¹´</option>`;
  endSelect.innerHTML+=`<option value="${y}">${y}å¹´</option>`;
}
startSelect.value=1980;
endSelect.value=2025;

// ===== æš´è½æƒ…å ± =====
const crashInfo={
1929:"ä¸–ç•Œææ…Œï¼šæ ªä¾¡æœ€å¤§90%ä¸‹è½ã€å›å¾©ã¾ã§25å¹´",
1973:"ã‚ªã‚¤ãƒ«ã‚·ãƒ§ãƒƒã‚¯ï¼šã‚¤ãƒ³ãƒ•ãƒ¬ã¨æ™¯æ°—å¾Œé€€",
2000:"ITãƒãƒ–ãƒ«å´©å£Šï¼šNASDAQ75%ä¸‹è½",
2008:"ãƒªãƒ¼ãƒãƒ³ã‚·ãƒ§ãƒƒã‚¯ï¼šä¸–ç•Œé‡‘èå±æ©Ÿ",
2020:"ã‚³ãƒ­ãƒŠã‚·ãƒ§ãƒƒã‚¯ï¼šãƒ‘ãƒ³ãƒ‡ãƒŸãƒƒã‚¯æš´è½"
};

function simulate(){
  const sY=Number(startSelect.value);
  const eY=Number(endSelect.value);
  if(sY>=eY){ alert("é–‹å§‹å¹´ã¯çµ‚äº†å¹´ã‚ˆã‚Šå‰ã«ã—ã¦ãã ã•ã„"); return; }

  let years=[];
  for(let y=sY;y<=eY;y++) years.push(y);

  let money=Number(initial.value);
  const monthlyAdd=Number(monthly.value)*12;
  const rate=Number(stock.value);
  const tax=account.value==="tax"?0.20315:0;
  const assets=[];

  years.forEach(y=>{
    if(crashOn.checked && crashInfo[y]) money*=0.7;
    money=(money+monthlyAdd)*(1+rate);
    assets.push(money);
  });

  final.innerText="Â¥"+Math.round(assets.at(-1)*(1-tax)).toLocaleString();
  drawGraph(assets);
}

function drawGraph(data){
  const c=document.getElementById("graph");
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);

  const max=Math.max(...data);
  const pad=30;
  const w=c.width-pad*2;
  const h=c.height-pad*2;

  ctx.beginPath();
  ctx.moveTo(pad,pad);
  ctx.lineTo(pad,c.height-pad);
  ctx.lineTo(c.width-pad,c.height-pad);
  ctx.stroke();

  ctx.beginPath();
  data.forEach((v,i)=>{
    const x=pad+(i/(data.length-1))*w;
    const y=c.height-pad-(v/max)*h;
    i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);
  });
  ctx.strokeStyle="#007aff";
  ctx.lineWidth=2;
  ctx.stroke();
}

simulate();
</script>

</body>
</html>
