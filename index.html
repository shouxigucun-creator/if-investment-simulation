<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>100å¹´æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  margin:12px;background:#f4f6f8
}
h1{font-size:22px}
.card{
  background:#fff;padding:12px;margin-bottom:12px;
  border-radius:10px
}
label{font-weight:bold}
input,select,button{
  width:100%;padding:8px;margin-top:6px
}
button{
  background:#007aff;color:#fff;border:none;border-radius:8px
}
.small{font-size:13px;color:#555}
#finalAmount{
  font-size:24px;
  font-weight:bold;
  color:#007aff;
  margin-top:8px
}
canvas{margin-top:20px}
</style>
</head>

<body>

<h1>ğŸ“ˆ 100å¹´æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
<p class="small">
â€» éå»ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ã—ãŸä»®å®šã§ã‚ã‚Šã€å°†æ¥ã®æˆæœã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“
</p>

<div class="card">
<label>æœˆé¡ç©ç«‹ï¼ˆå††ï¼‰</label>
<input id="monthly" type="number" value="30000">
</div>

<div class="card">
<label>æƒ³å®šåˆ©å›ã‚Š</label>
<select id="rate">
  <option value="0.03">3%</option>
  <option value="0.05">5%</option>
  <option value="0.07" selected>7%</option>
  <option value="0.10">10%</option>
</select>
</div>

<div class="card">
<label>å£åº§åŒºåˆ†</label>
<select id="account">
  <option value="nisa">æ–°NISAï¼ˆéèª²ç¨ï¼‰</option>
  <option value="tax">ç‰¹å®šå£åº§ï¼ˆç¨20%ï¼‰</option>
</select>
</div>

<div class="card">
<label>éŠ˜æŸ„â‘ </label>
<select id="brand1">
  <option value="0.001">ã‚ªãƒ«ã‚«ãƒ³</option>
  <option value="0.001">S&P500</option>
  <option value="0.002">NASDAQ100</option>
  <option value="0.003">é«˜é…å½“æ ª</option>
  <option value="0.0015">TOPIX</option>
  <option value="0.002">ä»»å¤©å ‚</option>
</select>

<label>éŠ˜æŸ„â‘¡ï¼ˆæ¯”è¼ƒï¼‰</label>
<select id="brand2">
  <option value="">æ¯”è¼ƒã—ãªã„</option>
  <option value="0.001">ã‚ªãƒ«ã‚«ãƒ³</option>
  <option value="0.001">S&P500</option>
  <option value="0.002">NASDAQ100</option>
  <option value="0.003">é«˜é…å½“æ ª</option>
  <option value="0.0015">TOPIX</option>
  <option value="0.002">ä»»å¤©å ‚</option>
</select>
</div>

<div class="card">
<label>
  <input type="checkbox" id="crashToggle" checked>
  æš´è½ã‚’åæ˜ ã™ã‚‹
</label>
</div>

<div class="card">
<button onclick="simulate()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>

<div id="finalAmount">æœ€çµ‚è³‡ç”£ï¼šâ€” å††</div>
<p id="notice" class="small"></p>
</div>

<canvas id="chart"></canvas>

<script>
let chart;
const crashYears=[1929,1973,1987,2000,2008,2020];

function calc(monthly,rate,fee,tax,crash){
  let total=0,data=[];
  for(let y=1925;y<=2025;y++){
    total=(total+monthly*12)*(1+rate-fee);
    if(crash && crashYears.includes(y)) total*=0.7;
    data.push(Math.round(total*(1-tax)));
  }
  return data;
}

function simulate(){
  const m=+monthly.value;
  const r=+rate.value;
  const tax=account.value==="tax"?0.2:0;
  const fee1=+brand1.value;
  const fee2=brand2.value?+brand2.value:null;
  const crash=crashToggle.checked;

  const d1=calc(m,r,fee1,tax,crash);
  const d2=fee2!==null?calc(m,r,fee2,tax,crash):null;

  const labels=[...Array(101)].map((_,i)=>1925+i);

  // âœ… æ–°NISAä¸Šé™ãƒã‚§ãƒƒã‚¯
  const invested=m*12*100;
  if(account.value==="nisa" && invested>18000000){
    notice.innerText="âš  æ–°NISAä¸Šé™ï¼ˆ1,800ä¸‡å††ï¼‰ã‚’è¶…ãˆã¦ã„ã¾ã™";
  }else{
    notice.innerText="";
  }

  // âœ… æœ€çµ‚è³‡ç”£ã‚’å¤§ããè¡¨ç¤º
  finalAmount.innerText=
    "æœ€çµ‚è³‡ç”£ï¼š " + d1.at(-1).toLocaleString() + " å††";

  if(chart) chart.destroy();
  chart=new Chart(chartCanvas,{
    type:"line",
    data:{
      labels,
      datasets:[
        {label:"éŠ˜æŸ„â‘ ",data:d1},
        d2?{label:"éŠ˜æŸ„â‘¡",data:d2}:null
      ].filter(Boolean)
    },
    options:{
      scales:{
        x:{title:{display:true,text:"å¹´"}},
        y:{title:{display:true,text:"é‡‘é¡ï¼ˆå††ï¼‰"}}
      }
    }
  });
}
</script>

</body>
</html>
