<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ–°NISA å®Ÿåœ¨å¹´è¡¨ãƒ¢ãƒ¼ãƒ‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family:sans-serif; background:#f4f6f8; padding:20px; }
.card { background:#fff; padding:20px; border-radius:10px; max-width:650px; margin:auto; }
input, button { width:100%; padding:10px; margin-top:10px; }
.info { font-size:14px; margin-top:10px; color:#444; }
</style>
</head>
<body>

<div class="card">
<h2>ğŸ“‰ æ–°NISA å®Ÿåœ¨å¹´è¡¨ãƒ¢ãƒ¼ãƒ‰</h2>
<p class="info">
å›ºå®šã‚¤ãƒ™ãƒ³ãƒˆï¼šITãƒãƒ–ãƒ« / ãƒªãƒ¼ãƒãƒ³ / ã‚³ãƒ­ãƒŠ<br>
ã€Œåˆ†ã‹ã£ã¦ã„ã¦ã‚‚è€ãˆã‚‰ã‚Œã‚‹ã‹ã€ã‚’æ¤œè¨¼
</p>

<label>æ¯æœˆã®ç©ç«‹é¡ï¼ˆå††ï¼‰</label>
<input type="number" id="monthly" value="100000">

<button onclick="nextYear()">â–¶ 1å¹´é€²ã‚ã‚‹</button>

<canvas id="chart" height="220"></canvas>

<p>
S&P500ï¼šÂ¥<span id="sp">0</span><br>
ã‚ªãƒ«ã‚«ãƒ³ï¼šÂ¥<span id="ac">0</span>
</p>
</div>

<script>
let year = 0;
let sp = 0;
let ac = 0;

const labels = [];
const spData = [];
const acData = [];

// å¹´è¡¨ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾©
const events = {
  10: { sp: -0.20, ac: -0.15, label: "ITãƒãƒ–ãƒ«å´©å£Š" },
  11: { sp: -0.15, ac: -0.10, label: "ITãƒãƒ–ãƒ«ç¶šè½" },
  12: { sp: -0.10, ac: -0.08, label: "ITãƒãƒ–ãƒ«ä½è¿·" },
  18: { sp: -0.37, ac: -0.30, label: "ãƒªãƒ¼ãƒãƒ³ã‚·ãƒ§ãƒƒã‚¯" },
  30: { sp: -0.30, ac: -0.25, label: "ã‚³ãƒ­ãƒŠã‚·ãƒ§ãƒƒã‚¯" }
};

// å¹³å¸¸å¹´ãƒªã‚¿ãƒ¼ãƒ³
const normal = { sp: 0.08, ac: 0.06 };

const chart = new Chart(document.getElementById("chart"), {
  type: "line",
  data: {
    labels,
    datasets: [
      { label: "S&P500", data: spData, borderWidth: 2 },
      { label: "ã‚ªãƒ«ã‚«ãƒ³", data: acData, borderWidth: 2 }
    ]
  },
  options: {
    responsive: true,
    scales: { y: { beginAtZero: true } }
  }
});

function nextYear() {
  if (year >= 35) return;

  year++;
  const monthly = Number(document.getElementById("monthly").value);
  sp += monthly * 12;
  ac += monthly * 12;

  let rSP = normal.sp;
  let rAC = normal.ac;
  let eventText = "é€šå¸¸å¹´";

  if (events[year]) {
    rSP = events[year].sp;
    rAC = events[year].ac;
    eventText = events[year].label;
    alert(`ğŸ“‰ ${year}å¹´ç›®ï¼š${eventText}`);
  }

  sp *= (1 + rSP);
  ac *= (1 + rAC);

  labels.push(`${year}å¹´`);
  spData.push(Math.round(sp));
  acData.push(Math.round(ac));

  chart.update();

  document.getElementById("sp").textContent = Math.round(sp).toLocaleString();
  document.getElementById("ac").textContent = Math.round(ac).toLocaleString();

  if (year === 35) {
    alert("ğŸ‰ 35å¹´å®Œèµ°\nã‚ãªãŸãŒè€ãˆã‚‰ã‚ŒãŸæ–¹ãŒã€æ­£è§£ã€ã§ã™");
  }
}
</script>

</body>
</html>
